import{S as M,i as H,s as J,k as P,q as S,a as T,l as v,m as k,r as A,h as o,c as g,n as b,b as h,E as w,O as B,Q as C,V as K,F,R as Q,o as Y}from"../chunks/index.ba8c4f3a.js";import{g as x}from"../chunks/navigation.640da136.js";import{l as z,P as D}from"../chunks/public.56157045.js";function L(c){let t,a;return{c(){t=P("p"),a=S("Payment failed. Please try again."),this.h()},l(s){t=v(s,"P",{class:!0});var i=k(t);a=A(i,"Payment failed. Please try again."),i.forEach(o),this.h()},h(){b(t,"class","error svelte-4i9m9b")},m(s,i){h(s,t,i),w(t,a)},d(s){s&&o(t)}}}function G(c){let t;return{c(){t=S("Pay with Alipay")},l(a){t=A(a,"Pay with Alipay")},m(a,s){h(a,t,s)},d(a){a&&o(t)}}}function W(c){let t;return{c(){t=S("Processing...")},l(a){t=A(a,"Processing...")},m(a,s){h(a,t,s)},d(a){a&&o(t)}}}function X(c){let t,a,s,i,u,y,E,d,f,l,p,m,I,R,r=c[0]&&L();function U(e,n){return e[1]?W:G}let N=U(c),_=N(c);return{c(){t=P("h1"),a=S("Alipay Example"),s=T(),i=P("nav"),u=P("a"),y=S("View code"),E=T(),r&&r.c(),d=T(),f=P("form"),l=P("input"),p=T(),m=P("button"),_.c(),this.h()},l(e){t=v(e,"H1",{});var n=k(t);a=A(n,"Alipay Example"),n.forEach(o),s=g(e),i=v(e,"NAV",{});var V=k(i);u=v(V,"A",{href:!0});var j=k(u);y=A(j,"View code"),j.forEach(o),V.forEach(o),E=g(e),r&&r.l(e),d=g(e),f=v(e,"FORM",{class:!0});var O=k(f);l=v(O,"INPUT",{name:!0,placeholder:!0,type:!0,class:!0}),p=g(O),m=v(O,"BUTTON",{class:!0});var q=k(m);_.l(q),q.forEach(o),O.forEach(o),this.h()},h(){b(u,"href","https://github.com/joshnuss/svelte-stripe/tree/main/src/routes/examples/alipay"),b(l,"name","email"),b(l,"placeholder","E-mail"),b(l,"type","email"),l.disabled=c[1],b(l,"class","svelte-4i9m9b"),m.disabled=c[1],b(m,"class","svelte-4i9m9b"),b(f,"class","svelte-4i9m9b")},m(e,n){h(e,t,n),w(t,a),h(e,s,n),h(e,i,n),w(i,u),w(u,y),h(e,E,n),r&&r.m(e,n),h(e,d,n),h(e,f,n),w(f,l),B(l,c[2]),w(f,p),w(f,m),_.m(m,null),I||(R=[C(l,"input",c[4]),C(f,"submit",K(c[3]))],I=!0)},p(e,[n]){e[0]?r||(r=L(),r.c(),r.m(d.parentNode,d)):r&&(r.d(1),r=null),n&2&&(l.disabled=e[1]),n&4&&l.value!==e[2]&&B(l,e[2]),N!==(N=U(e))&&(_.d(1),_=N(e),_&&(_.c(),_.m(m,null))),n&2&&(m.disabled=e[1])},i:F,o:F,d(e){e&&o(t),e&&o(s),e&&o(i),e&&o(E),r&&r.d(e),e&&o(d),e&&o(f),_.d(),I=!1,Q(R)}}}function Z(c,t,a){let s=null,i=null,u=!1,y;Y(async()=>{s=await z(D);const l=new URLSearchParams(window.location.search);a(0,i=l.get("error"))});async function E(){const l=await fetch("/examples/alipay/payment-intent",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({email:y})}),{clientSecret:p}=await l.json();return p}async function d(){if(u)return;a(1,u=!0);const l=await E(),p=await s.confirmAlipayPayment(l,{return_url:`${window.location.origin}/examples/alipay/return`});console.log({result:p}),p.error?(a(0,i=p.error),a(1,u=!1)):x("/examples/alipay/thanks")}function f(){y=this.value,a(2,y)}return[i,u,y,d,f]}class ae extends M{constructor(t){super(),H(this,t,Z,X,J,{})}}export{ae as component};
