import{S as L,i as Q,s as Y,k as P,q as V,a as N,l as k,m as K,r as g,h as m,c as S,n as p,b as E,E as h,O as T,Q as R,V as z,F as H,R as G,o as W}from"../chunks/index.ba8c4f3a.js";import{g as X}from"../chunks/navigation.640da136.js";import{l as Z,a as $}from"../chunks/public.56157045.js";function J(n){let t,l;return{c(){t=P("p"),l=V("Payment failed. Please try again."),this.h()},l(a){t=k(a,"P",{class:!0});var c=K(t);l=g(c,"Payment failed. Please try again."),c.forEach(m),this.h()},h(){p(t,"class","error svelte-4i9m9b")},m(a,c){E(a,t,c),h(t,l)},d(a){a&&m(t)}}}function x(n){let t;return{c(){t=V("Pay with Konbini")},l(l){t=g(l,"Pay with Konbini")},m(l,a){E(l,t,a)},d(l){l&&m(t)}}}function ee(n){let t;return{c(){t=V("Processing...")},l(l){t=g(l,"Processing...")},m(l,a){E(l,t,a)},d(l){l&&m(t)}}}function te(n){let t,l,a,c,_,w,b,d,r,o,q,u,U,i,O,y,A,B,f=n[0]&&J();function C(e,s){return e[1]?ee:x}let j=C(n),v=j(n);return{c(){t=P("h1"),l=V("Konbini Example"),a=N(),c=P("nav"),_=P("a"),w=V("View code"),b=N(),f&&f.c(),d=N(),r=P("form"),o=P("input"),q=N(),u=P("input"),U=N(),i=P("input"),O=N(),y=P("button"),v.c(),this.h()},l(e){t=k(e,"H1",{});var s=K(t);l=g(s,"Konbini Example"),s.forEach(m),a=S(e),c=k(e,"NAV",{});var F=K(c);_=k(F,"A",{href:!0});var M=K(_);w=g(M,"View code"),M.forEach(m),F.forEach(m),b=S(e),f&&f.l(e),d=S(e),r=k(e,"FORM",{class:!0});var I=K(r);o=k(I,"INPUT",{name:!0,placeholder:!0,type:!0,class:!0}),q=S(I),u=k(I,"INPUT",{name:!0,placeholder:!0,type:!0,class:!0}),U=S(I),i=k(I,"INPUT",{name:!0,placeholder:!0,type:!0,class:!0}),O=S(I),y=k(I,"BUTTON",{class:!0});var D=K(y);v.l(D),D.forEach(m),I.forEach(m),this.h()},h(){p(_,"href","https://github.com/joshnuss/svelte-stripe/tree/main/src/routes/examples/konbini"),p(o,"name","name"),p(o,"placeholder","Name"),p(o,"type","text"),o.required=!0,o.disabled=n[1],p(o,"class","svelte-4i9m9b"),p(u,"name","email"),p(u,"placeholder","E-mail"),p(u,"type","email"),u.required=!0,u.disabled=n[1],p(u,"class","svelte-4i9m9b"),p(i,"name","phone"),p(i,"placeholder","Phone"),p(i,"type","tel"),i.required=!0,i.disabled=n[1],p(i,"class","svelte-4i9m9b"),y.disabled=n[1],p(y,"class","svelte-4i9m9b"),p(r,"class","svelte-4i9m9b")},m(e,s){E(e,t,s),h(t,l),E(e,a,s),E(e,c,s),h(c,_),h(_,w),E(e,b,s),f&&f.m(e,s),E(e,d,s),E(e,r,s),h(r,o),T(o,n[3]),h(r,q),h(r,u),T(u,n[2]),h(r,U),h(r,i),T(i,n[4]),h(r,O),h(r,y),v.m(y,null),A||(B=[R(o,"input",n[6]),R(u,"input",n[7]),R(i,"input",n[8]),R(r,"submit",z(n[5]))],A=!0)},p(e,[s]){e[0]?f||(f=J(),f.c(),f.m(d.parentNode,d)):f&&(f.d(1),f=null),s&2&&(o.disabled=e[1]),s&8&&o.value!==e[3]&&T(o,e[3]),s&2&&(u.disabled=e[1]),s&4&&u.value!==e[2]&&T(u,e[2]),s&2&&(i.disabled=e[1]),s&16&&T(i,e[4]),j!==(j=C(e))&&(v.d(1),v=j(e),v&&(v.c(),v.m(y,null))),s&2&&(y.disabled=e[1])},i:H,o:H,d(e){e&&m(t),e&&m(a),e&&m(c),e&&m(b),f&&f.d(e),e&&m(d),e&&m(r),v.d(),A=!1,G(B)}}}async function le(){const n=await fetch("/examples/konbini/payment-intent",{method:"POST",headers:{"content-type":"application/json"}}),{clientSecret:t}=await n.json();return t}function ne(n,t,l){let a=null,c=null,_=!1,w,b,d;W(async()=>{a=await Z($)});async function r(){if(_)return;l(1,_=!0);const U=await le(),i=await a.confirmKonbiniPayment(U,{payment_method:{billing_details:{name:b,email:w}},payment_method_options:{konbini:{confirmation_number:d.replace(/\D/g,"")}}});if(console.log({result:i}),i.error)l(0,c=i.error),l(1,_=!1);else{const{hosted_voucher_url:O}=i.paymentIntent.next_action.konbini_display_details;X(`/examples/konbini/next-steps?hosted_voucher_url=${O}`)}}function o(){b=this.value,l(3,b)}function q(){w=this.value,l(2,w)}function u(){d=this.value,l(4,d)}return[c,_,w,b,d,r,o,q,u]}class re extends L{constructor(t){super(),Q(this,t,ne,te,Y,{})}}export{re as component};
